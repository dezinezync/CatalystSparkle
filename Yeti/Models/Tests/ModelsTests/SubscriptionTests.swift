//
//  SubscriptionTests.swift
//  
//
//  Created by Nikhil Nigade on 03/03/21.
//

import XCTest
@testable import Models

final class SubscriptionTests: XCTestCase {
    
    static func makeSub () -> Subscription {
        return Subscription(from: [
            "identifer": "1",
            "environment": "Production",
            "expiry": Subscription.dateFormatter.string(from: Date(timeIntervalSinceNow: 86400)),
            "created": "2018-06-01T00:00:00.000Z",
            "status": 1,
            "preAppStore": false
        ])
    }
    
    func testInitFromDict () {
        
        let sub = Self.makeSub()
        
        XCTAssertEqual(sub.identifier, 1)
        XCTAssertEqual(sub.environment, .Production)
        XCTAssertEqual(sub.hasExpired, false)
        XCTAssertEqual(sub.status, .active)
        XCTAssertEqual(sub.lifetime, false)
        XCTAssertEqual(sub.external, false)
        
    }
    
    func testLifetimeSub () {
        
        let sub = Self.makeSub()
        sub.expiry = Subscription.dateFormatter.date(from: "2025-12-31T00:00:00.000Z")

        XCTAssertEqual(sub.lifetime, true)
        XCTAssertEqual(sub.hasExpired, false)
        
    }
    
    func testSubWithDateInInit () {
        
        let sub = Subscription(from: [
            "identifer": "1",
            "environment": "Production",
            "expiry": Date(timeIntervalSinceNow: 86400),
            "created": "2018-06-01 00:00:00",
            "status": 1,
            "preAppStore": false
        ])
        
        XCTAssertEqual(sub.hasExpired, false)
        XCTAssertEqual(sub.lifetime, false)
        
    }
    
    func testSubWithNilExpiry () {
        
        let sub = Self.makeSub()
        sub.expiry = nil
        
        XCTAssertEqual(sub.hasExpired, true)
        XCTAssertEqual(sub.status, .expired)
        XCTAssertEqual(sub.lifetime, false)
        
    }
    
    func testSubDictRepresentation () {
        
        let sub = Self.makeSub()
        let dict = sub.dictionaryRepresentation
        
        XCTAssertEqual(sub.identifier, dict["id"] as? UInt)
        XCTAssertEqual(sub.environment.rawValue, dict["environment"] as! String)
        XCTAssertEqual(sub.status.rawValue, dict["status"] as! Int)
        XCTAssertEqual(Subscription.dateFormatter.string(from: sub.expiry), dict["expiry"] as! String)
        XCTAssertEqual(Subscription.dateFormatter.string(from: sub.created), dict["created"] as! String)
        XCTAssertEqual(sub.preAppStore, dict["preAppStore"] as! Bool)
        XCTAssertEqual(sub.lifetime, dict["lifetime"] as! Bool)
        XCTAssertEqual(sub.external, dict["external"] as! Bool)
    }
    
    func testSubWithStripeArrayInfo () {
        
        let sub = Self.makeSub()
        sub.setValue(stripeInfo, forUndefinedKey: "stripe")
        
        XCTAssertEqual(sub.hasExpired, false)
        XCTAssertEqual(sub.status, .active)
        XCTAssertEqual(sub.lifetime, false)
        
    }
    
    func testSubWithStripeDictInfo () {
        
        let sub = Self.makeSub()
        sub.setValue(stripeInfo, forUndefinedKey: "stripe")
        
        XCTAssertEqual(sub.hasExpired, false)
        XCTAssertEqual(sub.status, .active)
        XCTAssertEqual(sub.lifetime, false)
        
    }
    
    func testSubWithInvalidStripeInfo () {
        
        let sub = Subscription(from: [
            "identifer": "1",
            "environment": "Production",
            "created": "2018-06-01T00:00:00.000Z",
            "stripe": "[]"
        ])
        
        XCTAssertEqual(sub.hasExpired, true)
        XCTAssertEqual(sub.status, .expired)
        XCTAssertEqual(sub.lifetime, false)
        
    }
    
}

private let stripeInfo = "[{\"id\":\"sub_HNrCZD0cjA0nOz\",\"object\":\"subscription\",\"application_fee_percent\":null,\"billing_cycle_anchor\":1590986544,\"billing_thresholds\":null,\"cancel_at\":null,\"cancel_at_period_end\":false,\"canceled_at\":null,\"collection_method\":\"charge_automatically\",\"created\":1590986544,\"current_period_end\":1598935344,\"current_period_start\":1596256944,\"customer\":\"cus_HNrBkQDBc54JoD\",\"days_until_due\":null,\"default_payment_method\":\"pm_0Gp5TfxbZsoMC8kLYiYrZkAi\",\"default_source\":null,\"default_tax_rates\":[],\"discount\":null,\"ended_at\":null,\"items\":{\"object\":\"list\",\"data\":[{\"id\":\"si_HNrCTZFYtk93s2\",\"object\":\"subscription_item\",\"billing_thresholds\":null,\"created\":1590986544,\"metadata\":{},\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"price\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"price\",\"active\":true,\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"livemode\":true,\"lookup_key\":null,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"recurring\":{\"aggregate_usage\":null,\"interval\":\"month\",\"interval_count\":1,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"tiers_mode\":null,\"transform_quantity\":null,\"type\":\"recurring\",\"unit_amount\":7500,\"unit_amount_decimal\":\"7500\"},\"quantity\":1,\"subscription\":\"sub_HNrCZD0cjA0nOz\",\"tax_rates\":[]}],\"has_more\":false,\"total_count\":1,\"url\":\"/v1/subscription_items?subscription=sub_HNrCZD0cjA0nOz\"},\"latest_invoice\":\"in_0HBCYrxbZsoMC8kLXyh2EIpQ\",\"livemode\":true,\"metadata\":{},\"next_pending_invoice_item_invoice\":null,\"pause_collection\":null,\"pending_invoice_item_interval\":null,\"pending_setup_intent\":null,\"pending_update\":null,\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"quantity\":1,\"schedule\":null,\"start_date\":1590986544,\"status\":\"active\",\"tax_percent\":null,\"transfer_data\":null,\"trial_end\":null,\"trial_start\":null},{\"id\":\"sub_HNrCZD0cjA0nOz\",\"object\":\"subscription\",\"application_fee_percent\":null,\"billing_cycle_anchor\":1590986544,\"billing_thresholds\":null,\"cancel_at\":null,\"cancel_at_period_end\":false,\"canceled_at\":null,\"collection_method\":\"charge_automatically\",\"created\":1590986544,\"current_period_end\":1601527344,\"current_period_start\":1598935344,\"customer\":\"cus_HNrBkQDBc54JoD\",\"days_until_due\":null,\"default_payment_method\":\"pm_0Gp5TfxbZsoMC8kLYiYrZkAi\",\"default_source\":null,\"default_tax_rates\":[],\"discount\":null,\"ended_at\":null,\"items\":{\"object\":\"list\",\"data\":[{\"id\":\"si_HNrCTZFYtk93s2\",\"object\":\"subscription_item\",\"billing_thresholds\":null,\"created\":1590986544,\"metadata\":{},\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"price\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"price\",\"active\":true,\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"livemode\":true,\"lookup_key\":null,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"recurring\":{\"aggregate_usage\":null,\"interval\":\"month\",\"interval_count\":1,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"tiers_mode\":null,\"transform_quantity\":null,\"type\":\"recurring\",\"unit_amount\":7500,\"unit_amount_decimal\":\"7500\"},\"quantity\":1,\"subscription\":\"sub_HNrCZD0cjA0nOz\",\"tax_rates\":[]}],\"has_more\":false,\"total_count\":1,\"url\":\"/v1/subscription_items?subscription=sub_HNrCZD0cjA0nOz\"},\"latest_invoice\":\"in_0HMRLJxbZsoMC8kLh27gwMvd\",\"livemode\":true,\"metadata\":{},\"next_pending_invoice_item_invoice\":null,\"pause_collection\":null,\"pending_invoice_item_interval\":null,\"pending_setup_intent\":null,\"pending_update\":null,\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"quantity\":1,\"schedule\":null,\"start_date\":1590986544,\"status\":\"active\",\"tax_percent\":null,\"transfer_data\":null,\"trial_end\":null,\"trial_start\":null},{\"id\":\"sub_HNrCZD0cjA0nOz\",\"object\":\"subscription\",\"application_fee_percent\":null,\"billing_cycle_anchor\":1590986544,\"billing_thresholds\":null,\"cancel_at\":null,\"cancel_at_period_end\":false,\"canceled_at\":null,\"collection_method\":\"charge_automatically\",\"created\":1590986544,\"current_period_end\":1604205744,\"current_period_start\":1601527344,\"customer\":\"cus_HNrBkQDBc54JoD\",\"days_until_due\":null,\"default_payment_method\":\"pm_0Gp5TfxbZsoMC8kLYiYrZkAi\",\"default_source\":null,\"default_tax_rates\":[],\"discount\":null,\"ended_at\":null,\"items\":{\"object\":\"list\",\"data\":[{\"id\":\"si_HNrCTZFYtk93s2\",\"object\":\"subscription_item\",\"billing_thresholds\":null,\"created\":1590986544,\"metadata\":{},\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"price\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"price\",\"active\":true,\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"livemode\":true,\"lookup_key\":null,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"recurring\":{\"aggregate_usage\":null,\"interval\":\"month\",\"interval_count\":1,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"tiers_mode\":null,\"transform_quantity\":null,\"type\":\"recurring\",\"unit_amount\":7500,\"unit_amount_decimal\":\"7500\"},\"quantity\":1,\"subscription\":\"sub_HNrCZD0cjA0nOz\",\"tax_rates\":[]}],\"has_more\":false,\"total_count\":1,\"url\":\"/v1/subscription_items?subscription=sub_HNrCZD0cjA0nOz\"},\"latest_invoice\":\"in_0HXJcfxbZsoMC8kLyKNNWbHW\",\"livemode\":true,\"metadata\":{},\"next_pending_invoice_item_invoice\":null,\"pause_collection\":null,\"pending_invoice_item_interval\":null,\"pending_setup_intent\":null,\"pending_update\":null,\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"quantity\":1,\"schedule\":null,\"start_date\":1590986544,\"status\":\"active\",\"tax_percent\":null,\"transfer_data\":null,\"trial_end\":null,\"trial_start\":null},{\"id\":\"sub_HNrCZD0cjA0nOz\",\"object\":\"subscription\",\"application_fee_percent\":null,\"billing_cycle_anchor\":1590986544,\"billing_thresholds\":null,\"cancel_at\":null,\"cancel_at_period_end\":false,\"canceled_at\":null,\"collection_method\":\"charge_automatically\",\"created\":1590986544,\"current_period_end\":1606797744,\"current_period_start\":1604205744,\"customer\":\"cus_HNrBkQDBc54JoD\",\"days_until_due\":null,\"default_payment_method\":\"pm_0Gp5TfxbZsoMC8kLYiYrZkAi\",\"default_source\":null,\"default_tax_rates\":[],\"discount\":null,\"ended_at\":null,\"items\":{\"object\":\"list\",\"data\":[{\"id\":\"si_HNrCTZFYtk93s2\",\"object\":\"subscription_item\",\"billing_thresholds\":null,\"created\":1590986544,\"metadata\":{},\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"price\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"price\",\"active\":true,\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"livemode\":true,\"lookup_key\":null,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"recurring\":{\"aggregate_usage\":null,\"interval\":\"month\",\"interval_count\":1,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"tiers_mode\":null,\"transform_quantity\":null,\"type\":\"recurring\",\"unit_amount\":7500,\"unit_amount_decimal\":\"7500\"},\"quantity\":1,\"subscription\":\"sub_HNrCZD0cjA0nOz\",\"tax_rates\":[]}],\"has_more\":false,\"total_count\":1,\"url\":\"/v1/subscription_items?subscription=sub_HNrCZD0cjA0nOz\"},\"latest_invoice\":\"in_0HiYOjxbZsoMC8kLmgiUfxsf\",\"livemode\":true,\"metadata\":{},\"next_pending_invoice_item_invoice\":null,\"pause_collection\":null,\"pending_invoice_item_interval\":null,\"pending_setup_intent\":null,\"pending_update\":null,\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"quantity\":1,\"schedule\":null,\"start_date\":1590986544,\"status\":\"active\",\"tax_percent\":null,\"transfer_data\":null,\"trial_end\":null,\"trial_start\":null},{\"id\":\"sub_HNrCZD0cjA0nOz\",\"object\":\"subscription\",\"application_fee_percent\":null,\"billing_cycle_anchor\":1590986544,\"billing_thresholds\":null,\"cancel_at\":null,\"cancel_at_period_end\":false,\"canceled_at\":null,\"collection_method\":\"charge_automatically\",\"created\":1590986544,\"current_period_end\":1609476144,\"current_period_start\":1606797744,\"customer\":\"cus_HNrBkQDBc54JoD\",\"days_until_due\":null,\"default_payment_method\":\"pm_0Gp5TfxbZsoMC8kLYiYrZkAi\",\"default_source\":null,\"default_tax_rates\":[],\"discount\":null,\"ended_at\":null,\"items\":{\"object\":\"list\",\"data\":[{\"id\":\"si_HNrCTZFYtk93s2\",\"object\":\"subscription_item\",\"billing_thresholds\":null,\"created\":1590986544,\"metadata\":{},\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"price\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"price\",\"active\":true,\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"livemode\":true,\"lookup_key\":null,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"recurring\":{\"aggregate_usage\":null,\"interval\":\"month\",\"interval_count\":1,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"tiers_mode\":null,\"transform_quantity\":null,\"type\":\"recurring\",\"unit_amount\":7500,\"unit_amount_decimal\":\"7500\"},\"quantity\":1,\"subscription\":\"sub_HNrCZD0cjA0nOz\",\"tax_rates\":[]}],\"has_more\":false,\"total_count\":1,\"url\":\"/v1/subscription_items?subscription=sub_HNrCZD0cjA0nOz\"},\"latest_invoice\":\"in_0HtQhOxbZsoMC8kLWB9Om5B6\",\"livemode\":true,\"metadata\":{},\"next_pending_invoice_item_invoice\":null,\"pause_collection\":null,\"pending_invoice_item_interval\":null,\"pending_setup_intent\":null,\"pending_update\":null,\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"quantity\":1,\"schedule\":null,\"start_date\":1590986544,\"status\":\"active\",\"tax_percent\":null,\"transfer_data\":null,\"trial_end\":null,\"trial_start\":null},{\"id\":\"sub_HNrCZD0cjA0nOz\",\"object\":\"subscription\",\"application_fee_percent\":null,\"billing_cycle_anchor\":1590986544,\"billing_thresholds\":null,\"cancel_at\":null,\"cancel_at_period_end\":false,\"canceled_at\":null,\"collection_method\":\"charge_automatically\",\"created\":1590986544,\"current_period_end\":1612154544,\"current_period_start\":1609476144,\"customer\":\"cus_HNrBkQDBc54JoD\",\"days_until_due\":null,\"default_payment_method\":\"pm_0Gp5TfxbZsoMC8kLYiYrZkAi\",\"default_source\":null,\"default_tax_rates\":[],\"discount\":null,\"ended_at\":null,\"items\":{\"object\":\"list\",\"data\":[{\"id\":\"si_HNrCTZFYtk93s2\",\"object\":\"subscription_item\",\"billing_thresholds\":null,\"created\":1590986544,\"metadata\":{},\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"price\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"price\",\"active\":true,\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"livemode\":true,\"lookup_key\":null,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"recurring\":{\"aggregate_usage\":null,\"interval\":\"month\",\"interval_count\":1,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"tiers_mode\":null,\"transform_quantity\":null,\"type\":\"recurring\",\"unit_amount\":7500,\"unit_amount_decimal\":\"7500\"},\"quantity\":1,\"subscription\":\"sub_HNrCZD0cjA0nOz\",\"tax_rates\":[]}],\"has_more\":false,\"total_count\":1,\"url\":\"/v1/subscription_items?subscription=sub_HNrCZD0cjA0nOz\"},\"latest_invoice\":\"in_0I4fTAxbZsoMC8kLqaXO4j7W\",\"livemode\":true,\"metadata\":{},\"next_pending_invoice_item_invoice\":null,\"pause_collection\":null,\"pending_invoice_item_interval\":null,\"pending_setup_intent\":null,\"pending_update\":null,\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"quantity\":1,\"schedule\":null,\"start_date\":1590986544,\"status\":\"active\",\"tax_percent\":null,\"transfer_data\":null,\"trial_end\":null,\"trial_start\":null},{\"id\":\"sub_HNrCZD0cjA0nOz\",\"object\":\"subscription\",\"application_fee_percent\":null,\"billing_cycle_anchor\":1590986544,\"billing_thresholds\":null,\"cancel_at\":null,\"cancel_at_period_end\":false,\"canceled_at\":null,\"collection_method\":\"charge_automatically\",\"created\":1590986544,\"current_period_end\":1614573744,\"current_period_start\":1612154544,\"customer\":\"cus_HNrBkQDBc54JoD\",\"days_until_due\":null,\"default_payment_method\":\"pm_0Gp5TfxbZsoMC8kLYiYrZkAi\",\"default_source\":null,\"default_tax_rates\":[],\"discount\":null,\"ended_at\":null,\"items\":{\"object\":\"list\",\"data\":[{\"id\":\"si_HNrCTZFYtk93s2\",\"object\":\"subscription_item\",\"billing_thresholds\":null,\"created\":1590986544,\"metadata\":{},\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"price\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"price\",\"active\":true,\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"livemode\":true,\"lookup_key\":null,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"recurring\":{\"aggregate_usage\":null,\"interval\":\"month\",\"interval_count\":1,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"tiers_mode\":null,\"transform_quantity\":null,\"type\":\"recurring\",\"unit_amount\":7500,\"unit_amount_decimal\":\"7500\"},\"quantity\":1,\"subscription\":\"sub_HNrCZD0cjA0nOz\",\"tax_rates\":[]}],\"has_more\":false,\"total_count\":1,\"url\":\"/v1/subscription_items?subscription=sub_HNrCZD0cjA0nOz\"},\"latest_invoice\":\"in_0IFuFAxbZsoMC8kLDCMuqgwi\",\"livemode\":true,\"metadata\":{},\"next_pending_invoice_item_invoice\":null,\"pause_collection\":null,\"pending_invoice_item_interval\":null,\"pending_setup_intent\":null,\"pending_update\":null,\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"quantity\":1,\"schedule\":null,\"start_date\":1590986544,\"status\":\"active\",\"tax_percent\":null,\"transfer_data\":null,\"trial_end\":null,\"trial_start\":null},{\"id\":\"sub_HNrCZD0cjA0nOz\",\"object\":\"subscription\",\"application_fee_percent\":null,\"billing_cycle_anchor\":1590986544,\"billing_thresholds\":null,\"cancel_at\":null,\"cancel_at_period_end\":false,\"canceled_at\":null,\"collection_method\":\"charge_automatically\",\"created\":1590986544,\"current_period_end\":1617252144,\"current_period_start\":1614573744,\"customer\":\"cus_HNrBkQDBc54JoD\",\"days_until_due\":null,\"default_payment_method\":\"pm_0Gp5TfxbZsoMC8kLYiYrZkAi\",\"default_source\":null,\"default_tax_rates\":[],\"discount\":null,\"ended_at\":null,\"items\":{\"object\":\"list\",\"data\":[{\"id\":\"si_HNrCTZFYtk93s2\",\"object\":\"subscription_item\",\"billing_thresholds\":null,\"created\":1590986544,\"metadata\":{},\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"price\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"price\",\"active\":true,\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"livemode\":true,\"lookup_key\":null,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"recurring\":{\"aggregate_usage\":null,\"interval\":\"month\",\"interval_count\":1,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"tiers_mode\":null,\"transform_quantity\":null,\"type\":\"recurring\",\"unit_amount\":7500,\"unit_amount_decimal\":\"7500\"},\"quantity\":1,\"subscription\":\"sub_HNrCZD0cjA0nOz\",\"tax_rates\":[]}],\"has_more\":false,\"total_count\":1,\"url\":\"/v1/subscription_items?subscription=sub_HNrCZD0cjA0nOz\"},\"latest_invoice\":\"in_0IQ3afxbZsoMC8kLOH3OxLAe\",\"livemode\":true,\"metadata\":{},\"next_pending_invoice_item_invoice\":null,\"pause_collection\":null,\"pending_invoice_item_interval\":null,\"pending_setup_intent\":null,\"pending_update\":null,\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"quantity\":1,\"schedule\":null,\"start_date\":1590986544,\"status\":\"active\",\"tax_percent\":null,\"transfer_data\":null,\"trial_end\":null,\"trial_start\":null}]"


private let stripeDictInfo = "{\"id\":\"sub_HNrCZD0cjA0nOz\",\"object\":\"subscription\",\"application_fee_percent\":null,\"billing_cycle_anchor\":1590986544,\"billing_thresholds\":null,\"cancel_at\":null,\"cancel_at_period_end\":false,\"canceled_at\":null,\"collection_method\":\"charge_automatically\",\"created\":1590986544,\"current_period_end\":1617252144,\"current_period_start\":1614573744,\"customer\":\"cus_HNrBkQDBc54JoD\",\"days_until_due\":null,\"default_payment_method\":\"pm_0Gp5TfxbZsoMC8kLYiYrZkAi\",\"default_source\":null,\"default_tax_rates\":[],\"discount\":null,\"ended_at\":null,\"items\":{\"object\":\"list\",\"data\":[{\"id\":\"si_HNrCTZFYtk93s2\",\"object\":\"subscription_item\",\"billing_thresholds\":null,\"created\":1590986544,\"metadata\":{},\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"price\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"price\",\"active\":true,\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"livemode\":true,\"lookup_key\":null,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"recurring\":{\"aggregate_usage\":null,\"interval\":\"month\",\"interval_count\":1,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"tiers_mode\":null,\"transform_quantity\":null,\"type\":\"recurring\",\"unit_amount\":7500,\"unit_amount_decimal\":\"7500\"},\"quantity\":1,\"subscription\":\"sub_HNrCZD0cjA0nOz\",\"tax_rates\":[]}],\"has_more\":false,\"total_count\":1,\"url\":\"/v1/subscription_items?subscription=sub_HNrCZD0cjA0nOz\"},\"latest_invoice\":\"in_0IQ3afxbZsoMC8kLOH3OxLAe\",\"livemode\":true,\"metadata\":{},\"next_pending_invoice_item_invoice\":null,\"pause_collection\":null,\"pending_invoice_item_interval\":null,\"pending_setup_intent\":null,\"pending_update\":null,\"plan\":{\"id\":\"plan_HA3wChf0DvzGl1\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":7500,\"amount_decimal\":\"7500\",\"billing_scheme\":\"per_unit\",\"created\":1587805006,\"currency\":\"inr\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{},\"nickname\":\"Monthly-1-IN\",\"product\":\"prod_GwaS534PUfrSBh\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\"},\"quantity\":1,\"schedule\":null,\"start_date\":1590986544,\"status\":\"active\",\"tax_percent\":null,\"transfer_data\":null,\"trial_end\":null,\"trial_start\":null}"
